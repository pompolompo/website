[
  {
    "objectID": "about-es.html",
    "href": "about-es.html",
    "title": "Ferran Garcia",
    "section": "",
    "text": "English  Català  Español\n\n\nSoy un estadístico y economista orientado a resultados, con actitud proactiva y ganas de seguir aprendiendo. Me especializo en analizar y modelizar datos para extraer información de interés y comunicarla.\n\nEducation: Doble grado en Economía y Estadística por la UB y UPC. Intercambio Erasmus anual en Maastrich y semestral en Sevilla.\nExperience: Becario del departamento de Estadística de la universidad (2 años). Analista de datos comerciales en Amplifon (1 año). Trabajos a tiempo parcial (árbitro, recepcionista, profesor, camarero)\nProjects: Estadística Bayesiana, Modelos Espacio-Tiempo, Web Scrapping, Mercado Inmobiliario, Mercados Financieros"
  },
  {
    "objectID": "about-ca.html",
    "href": "about-ca.html",
    "title": "Ferran Garcia",
    "section": "",
    "text": "English  Català  Español\n\n\nSóc un estadístic i economista orientat a resultats, amb actitud proactiva i ganes de seguir aprenent. M’especialitzo en analitzar i modelitzar dades per extreure informació d’interès i comunicar-la.\n\nEducation: Doble grau en Estadística i Economia a la UPC i UB. Intercanvi Erasmus anual a Maastricht i semestral a Sevilla.\nExperience: Becari estadística de l’universitat (2 anys) i analista de dades comercials a Amplifon (1 any), altres feines a temps parcial (àribtre, recepcionista, professor, cambrer)\nInteresos: Estadística Bayesiana, Models Espai - Temps, Web Scrapping, Mercat Inmobiliari, Mercats Financers"
  },
  {
    "objectID": "notes/ca/geoportal_api/index.html",
    "href": "notes/ca/geoportal_api/index.html",
    "title": "Preus a les gasolineres d’Espanya",
    "section": "",
    "text": "On s’ón’ubiquen els punts de recàrrega?\nQuin carburant ofereixen?\nQuin preu cobren? Com canvia al llarg del temps?\nQuin horari obre?\nÉs d’autoservei?\nÉs una cooperativa?\nQui n’és el propietari?\nExisteixen portals similars a Europa"
  },
  {
    "objectID": "notes/ca/geoportal_api/index.html#quina-informació-hi-ha-al-geoportal",
    "href": "notes/ca/geoportal_api/index.html#quina-informació-hi-ha-al-geoportal",
    "title": "Preus a les gasolineres d’Espanya",
    "section": "",
    "text": "On s’ón’ubiquen els punts de recàrrega?\nQuin carburant ofereixen?\nQuin preu cobren? Com canvia al llarg del temps?\nQuin horari obre?\nÉs d’autoservei?\nÉs una cooperativa?\nQui n’és el propietari?\nExisteixen portals similars a Europa"
  },
  {
    "objectID": "notes/ca/geoportal_api/index.html#com-obtenim-les-dades",
    "href": "notes/ca/geoportal_api/index.html#com-obtenim-les-dades",
    "title": "Preus a les gasolineres d’Espanya",
    "section": "Com obtenim les dades?",
    "text": "Com obtenim les dades?\n\nConnexió amb la API\nCal connectarnos a la API del geoportal per obtenir les dades que ens interessen. Descarregarem en format .json, que R llegirà com llista. Finalment apilarem totes les observacions en una taula.\nEl geoportal ofereix múltiples APIs que donen accés a diferent informació (Servicios REST). Estem interessats en l’evolució dels preus de cada producte així que utilitzem la següent estructura:\nPart comú: Sempre serà la mateixa\nhttps://sedeaplicaciones.minetur.gob.es/ServiciosRESTCarburantes/PreciosCarburantes/\nPart Específica: Escollirem i parametritzarem en funció de l’informació que volem\nEstacionesTerrestresHist/FiltroProvinciaProducto/{FECHA}/{IDPROVINCIA}/{IDPRODUCTO}\n\n\nExemple en R\nUtilitzarem les següents llibreries d’R:\n\nsuppressWarnings(suppressMessages({\n  library(dplyr)\n  library(purrr)\n  library(httr2)\n}))\n\nEstem interessats en el preu de la gasolina 95 E5. Ens centrem en la província de Barcelona i volem l’informació del dia anterior. Els productes i províncies tenen codis associats, codificarem la data en format dd-mm-yy:\n\ndata &lt;- format(Sys.Date() - 1, \"%d-%m-%Y\")\nproducte &lt;- \"01\"\nprovincies &lt;- set_names(\n  c(\"08\", \"17\", \"25\", \"43\"), \n  c(\"barcelona\", \"girona\", \"lleida\", \"tarragona\")\n)\n\nConstruim l’url per cada província:\n\nbase_url &lt;- provincies %&gt;% \n  map(\\(prov) paste0(\n    \"https://sedeaplicaciones.minetur.gob.es/\",\n    \"ServiciosRESTCarburantes/PreciosCarburantes/\",\n    \"EstacionesTerrestresHist/FiltroProvinciaProducto/\",\n    data, \"/\", prov, \"/\", producte\n))\n\nDemanem l’informació, la convertim en llista i l’apilem en una taula per cada província:\n\nresponse &lt;- map(base_url, \\(url) req_perform(request(url)))\n\ntbl &lt;- response %&gt;% \n  map(\\(resp){\n    resp_body_json(resp)[[\"ListaEESSPrecio\"]] %&gt;% \n      map(\\(json) as_tibble(list_flatten(json))) %&gt;% \n      bind_rows() %&gt;% \n      mutate(PrecioProducto = as.numeric(sub(\",\", \".\", PrecioProducto)))\n  })\n\nFem una ullada als preus:\n\nwith(list_c(tbl), boxplot(PrecioProducto ~ Provincia, xlab = \"\", ylab = \"\"))\n\n\n\n\n\n\n\n\n\nhist(list_c(tbl)[[\"PrecioProducto\"]], breaks = 30, main = \"\", xlab = \"\", ylab = \"\")"
  },
  {
    "objectID": "notes/ca/geoportal_api/index.html#més-enllà",
    "href": "notes/ca/geoportal_api/index.html#més-enllà",
    "title": "Preus a les gasolineres d’Espanya",
    "section": "Més enllà",
    "text": "Més enllà\n\nMapa de preus de gasolineres"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Ferran Garcia",
    "section": "",
    "text": "Preus de benzina - Geoportal\n\n\n\n\n\n\n\n\n\n\n\n\n\nEvolution of gas prices in Llinars del Vallès\n\n\n\n\n\n\n\n\nFeb 12, 2024\n\n\n\n\n\n\n\nPreus a les gasolineres d’Espanya\n\n\nQuinen preus fixen les gasolineres per cada producte al llarg del temps?\n\n\n\n\n\nFeb 11, 2024\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "notes/ca/geoportal/index.html",
    "href": "notes/ca/geoportal/index.html",
    "title": "Preus de benzina - Geoportal",
    "section": "",
    "text": "Preus de benzina a Espanya, sèries temporals (freqüència diària) desagregades a nivell de gasolinera. El Ministerio de transición ecológica ens ofereix l’informació a través d’una API 1 que es diu Geoportal."
  },
  {
    "objectID": "notes/ca/geoportal/index.html#context",
    "href": "notes/ca/geoportal/index.html#context",
    "title": "Preus de benzina - Geoportal",
    "section": "",
    "text": "Preus de benzina a Espanya, sèries temporals (freqüència diària) desagregades a nivell de gasolinera. El Ministerio de transición ecológica ens ofereix l’informació a través d’una API 1 que es diu Geoportal."
  },
  {
    "objectID": "notes/ca/geoportal/index.html#delimitació-de-la-població",
    "href": "notes/ca/geoportal/index.html#delimitació-de-la-població",
    "title": "Preus de benzina - Geoportal",
    "section": "Delimitació de la població",
    "text": "Delimitació de la població\nTenim moltes dades, per simplicitat comencem considerant un subconjunt de la població. Ens interessem pels preus de cert producte a les benzineres (estacions terrestres) 2 ubicades en un llistat de municipis en cert hortitzó temporal. Per exemple:\n\n\n\nMunicipis\nHoritzó\nProducte\n\n\n\n\nCardedeu\n01/01/2022 - …\nBenzina 95\n\n\nLlinars del Vallès\n\n\n\n\nSant Antoni de Vilamajor\n\n\n\n\nSant Celoni\n\n\n\n\nSanta Maria de Palautordera"
  },
  {
    "objectID": "notes/ca/geoportal/index.html#obtenció-de-les-dades",
    "href": "notes/ca/geoportal/index.html#obtenció-de-les-dades",
    "title": "Preus de benzina - Geoportal",
    "section": "Obtenció de les dades",
    "text": "Obtenció de les dades\nA l’apartat de descàrregues del Geoportal trobarem les consultes que necessitem sota la secció preus. Podem accedir a l’informació de diferents formes, utilitzarem R per comoditat. Per comunicar-nos amb l’API, agrupar, netejar i guardar les dades farem servir les següents llibreries:\n\nlibrary(httr2)      # comunicació amb l'API\nlibrary(purrr)      # paralelització\nlibrary(dplyr)      # manipulació de dades\nlibrary(janitor)    # neteja noms de dades\nlibrary(ggplot2)    # visualitzacions\nlibrary(knitr)      # taules\n\n\nPer fer una consulta cal seguir els següents passos:\n\nDecidir quina és la consulta\nParametritzar la consulta (si cal)\nPetició i resposta de l’API\n\n\nQuina és la consulta?\nDisposem d’unes 20 consultes diferents que ens permeten descarregar informació sota diferents filtres. Cadascuna consta d’una descripció, una url i un exemple:\n\n\n\nAPI del Geoportal del Ministerio\n\n\n\n\nParametrització de la consulta\nAlgunes consultes no requereixen cap paràmetre, són una mena de llista informativa. Altres requereixen delimitar l’informació que es demana. La data del calendari, el tipus de producte o la regió son els paràmetres més freqüents.\nUna forma d’obtenir els preus dins de la zona i horitzó que considerem és utilitzant els codis municipals. Primer trobarem el codi de la provincia de Barcelona i l’utilitzarem per trobar els codis dels municipis desitjats.\nAmb els codis municipals, el codi de producte petrolífer i un l’horitzó temporal delimitat podrem descarregar els preus de benzina per l’interval i la zona que sigui necessari.\n\n\nPetició i resposta de l’API\nPrimer ens ocuparem del llistat de províncies i del producte. Busquem els identificadors de la benzina 95 e5 i la provincia de Barcelona.\n\n# base url\nurl &lt;- \"https://sedeaplicaciones.minetur.gob.es/ServiciosRESTCarburantes/PreciosCarburantes\"\n\n# endpoints without params\ndict &lt;- paste0(url, c(\n  \"/Listados/Provincias/\", \"/Listados/ProductosPetroliferos/\"\n)) %&gt;% \n  set_names(c(\"prov\", \"prod\")) %&gt;% \n  map(\\(x){\n    request(x) %&gt;% \n    req_perform() %&gt;% \n    resp_body_json() %&gt;% \n    map(\\(json) as_tibble(list_flatten(json))) %&gt;% \n    bind_rows() %&gt;% \n    clean_names()\n})\n\n# province and product id\nid_prov &lt;- dict$prov %&gt;% \n  filter(grepl(\"barcelona\", provincia, ignore.case = TRUE)) %&gt;% \n  with(set_names(id_povincia, provincia)); id_prov # tenen el nom mal escrit...\n\nBARCELONA \n     \"08\" \n\nid_prod &lt;- dict$prod %&gt;% \n  filter(grepl(\"gasolina 95 e5$\", nombre_producto, ignore.case = TRUE)) %&gt;% \n  with(set_names(id_producto, nombre_producto_abreviatura)); id_prod\n\nG95E5 \n  \"1\" \n\n\nAra farem una consulta per obtenir els codis dels municipis d’interès a partir del codi de província de Barcelona.\n\n# municipalities id\nmuns &lt;- paste0(url, \"/Listados/MunicipiosPorProvincia/\", id_prov) %&gt;% \n  request() %&gt;% \n  req_perform() %&gt;% \n  resp_body_json() %&gt;%  \n  bind_rows() %&gt;% \n  filter(grepl(\n    pattern = \"^Llinars|Cardedeu|Vilamajor|Palautordera|Sant Celoni\", \n    x = Municipio, ignore.case = TRUE\n    )) %&gt;% \n  distinct(IDMunicipio, Municipio) %&gt;% \n  with(set_names(IDMunicipio, Municipio)); muns\n\n                   Cardedeu          Llinars del Vallès \n                      \"908\"                       \"973\" \n   Sant Antoni de Vilamajor                 Sant Celoni \n                     \"1060\"                      \"1065\" \nSant Esteve de Palautordera      Sant Pere de Vilamajor \n                     \"1069\"                      \"1095\" \nSanta Maria de Palautordera \n                     \"1123\" \n\n\nJa tenim tots els paràmetres necessaris per fer la nostra consulta. Només ens falta definir l’horitzó temporal i executar la consulta.\n\nhoritzo &lt;- format(seq.Date(as.Date(\"2010/01/01\"), Sys.Date() - 1, \"day\"), \"%d-%m-%Y\")\nt &lt;- Sys.time()\npreu &lt;- expand.grid(dia = horitzo, mun = muns) %&gt;% \n  pmap(\\(dia, mun){\n    url %&gt;% \n      paste0(\"/EstacionesTerrestresHist/FiltroMunicipioProducto/\") %&gt;% \n      paste0(dia, \"/\", mun, \"/\", id_prod) %&gt;% \n      request() %&gt;% \n      req_perform() %&gt;% \n      resp_body_json() %&gt;% \n      .[[\"ListaEESSPrecio\"]] %&gt;% \n      lapply(as_tibble) %&gt;% \n      bind_rows() %&gt;% \n      mutate(dia = dia)\n  }) %&gt;% \n  bind_rows() %&gt;% \n  clean_names()\n\n#write.csv2(preu, \"data/preu.csv\")\nSys.time() - t\n\nNo l’evaluarem si no és necessari ja que tarda uns minuts, utilitzarem una versió recent.\n\n\nRows: 77,476\nColumns: 19\n$ c_p             &lt;int&gt; 8440, 8440, 8440, 8440, 8440, 8440, 8440, 8440, 8440, …\n$ direccion       &lt;chr&gt; \"CARRETERA C-251 KM. 5,5\", \"CARRETERA C-251 KM. 5,5\", …\n$ horario         &lt;chr&gt; \"L-D: 06:00-22:00\", \"L-D: 06:00-22:00\", \"L-D: 06:00-22…\n$ latitud         &lt;dbl&gt; 41.63481, 41.63522, 41.63481, 41.63522, 41.63481, 41.6…\n$ localidad       &lt;chr&gt; \"CARDEDEU                 \", \"CARDEDEU                …\n$ longitud_wgs84  &lt;dbl&gt; 2.340139, 2.339722, 2.340139, 2.339722, 2.340139, 2.33…\n$ margen          &lt;chr&gt; \"D\", \"I\", \"D\", \"I\", \"D\", \"I\", \"D\", \"I\", \"D\", \"I\", \"D\",…\n$ municipio       &lt;chr&gt; \"Cardedeu\", \"Cardedeu\", \"Cardedeu\", \"Cardedeu\", \"Carde…\n$ precio_producto &lt;dbl&gt; 1.108, 1.108, 1.108, 1.108, 1.108, 1.108, 1.108, 1.108…\n$ provincia       &lt;chr&gt; \"BARCELONA\", \"BARCELONA\", \"BARCELONA\", \"BARCELONA\", \"B…\n$ remision        &lt;chr&gt; \"OM\", \"OM\", \"OM\", \"OM\", \"OM\", \"OM\", \"OM\", \"OM\", \"OM\", …\n$ rotulo          &lt;chr&gt; \"REPSOL\", \"REPSOL\", \"REPSOL\", \"REPSOL\", \"REPSOL\", \"REP…\n$ tipo_venta      &lt;chr&gt; \"P\", \"P\", \"P\", \"P\", \"P\", \"P\", \"P\", \"P\", \"P\", \"P\", \"P\",…\n$ ideess          &lt;int&gt; 2509, 2510, 2509, 2510, 2509, 2510, 2509, 2510, 2509, …\n$ id_municipio    &lt;int&gt; 908, 908, 908, 908, 908, 908, 908, 908, 908, 908, 908,…\n$ id_provincia    &lt;int&gt; 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, …\n$ idccaa          &lt;int&gt; 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, …\n$ dia             &lt;date&gt; 2010-01-01, 2010-01-01, 2010-01-02, 2010-01-02, 2010-…\n$ preu            &lt;dbl&gt; 1.108, 1.108, 1.108, 1.108, 1.108, 1.108, 1.108, 1.108…\n\n\nConté informació sobre el preu de G95E5 en 0 municipis de la provincia de ."
  },
  {
    "objectID": "notes/ca/geoportal/index.html#descriptiva",
    "href": "notes/ca/geoportal/index.html#descriptiva",
    "title": "Preus de benzina - Geoportal",
    "section": "Descriptiva",
    "text": "Descriptiva\nFem una ullada a les nostres dades. Plantegem qüestións d’interès a primera vista.\n\nComparació de grups (municipis, estacions, codis postals…)\nMapa de les gasolineres\nQuantitats d’interès (i.e mean(preu) - median(preu))\nSèries estacionàries? Cointegrables? VAR?"
  },
  {
    "objectID": "notes/ca/geoportal/index.html#footnotes",
    "href": "notes/ca/geoportal/index.html#footnotes",
    "title": "Preus de benzina - Geoportal",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nAPI: Interfície de programació d’aplicacions. Permet l’intercanvi d’informació entre diferents programes informàtics.↩︎\nNo s’incluouen els possibles punts de racàrrega matrítims↩︎"
  },
  {
    "objectID": "notes/en/gas_price_time/index.html",
    "href": "notes/en/gas_price_time/index.html",
    "title": "Evolution of gas prices in Llinars del Vallès",
    "section": "",
    "text": "Use this R libraries:\nlibrary(httr2)\nlibrary(dplyr)\nlibrary(purrr)\nlibrary(tidyr)\nlibrary(stringr)\nlibrary(ggplot2)\ntheme_set(\n  theme_bw() +\n  theme(\n    axis.title = element_blank()\n  )\n)\nDefine function to retrieve information:\nget_gas &lt;- function(filtro, args) {\n  paste0(\n    \"https://sedeaplicaciones.minetur.gob.es\",\n    \"/ServiciosRESTCarburantes/PreciosCarburantes/EstacionesTerrestresHist/\",\n    filtro, paste(args, collapse = \"/\")\n  ) %&gt;%\n    request() %&gt;%\n    req_perform() %&gt;%\n    resp_body_json() %&gt;%\n    .[[\"ListaEESSPrecio\"]] %&gt;%\n    map(\\(x) as_tibble(list_flatten(x))) %&gt;%\n    bind_rows() %&gt;%\n    janitor::clean_names()\n}\nRetrieve yesterday’s gas prices in catalan provinces:\nprov &lt;- c(\"08\", \"43\", \"17\", \"25\")\n\ngCat &lt;- map(prov, \\(x) get_gas(\n  filtro = \"FiltroProvincia/\",\n  args = c(format(Sys.Date() - 1, \"%d-%m-%Y\"), x)\n)) %&gt;%\n  bind_rows() %&gt;%\n  mutate(precio = as.numeric(gsub(\",\", \".\", precio_gasolina_95_e5)))\nSummary of gas stations and price statistics per province:1\ngCat %&gt;%\n  summarise(\n    n = n(),\n    mean = mean(precio, na.rm = TRUE) %&gt;% round(3),\n    median = median(precio, na.rm = TRUE) %&gt;% round(3),\n    sd = sd(precio, na.rm = TRUE) %&gt;% round(3),\n    .by = provincia\n  )\n\n# A tibble: 4 × 5\n  provincia     n  mean median    sd\n  &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;\n1 BARCELONA   810  1.55   1.59 0.108\n2 TARRAGONA   236  1.55   1.61 0.106\n3 GIRONA      267  1.55   1.59 0.082\n4 LLEIDA      188  1.51   1.55 0.093\nPrices from the largest providers in Catalonia, 2025:\ngCat %&gt;%\n  filter(rotulo %in% (\n    summarise(gCat, .by = rotulo, n = n()) %&gt;%\n      arrange(n) %&gt;% pull(rotulo) %&gt;% tail(10)\n  )) %&gt;%\n  drop_na() %&gt;%\n  select(rotulo, precio) %&gt;%\n  ggplot(aes(rotulo, precio)) +\n  geom_boxplot() +\n  labs(\n    title = \"Gas prices in Catalonia, 2025\",\n    subtitle = \"Euros per litre of gas 95 E5 (10 largest providers)\"\n  )\nNarrow down geographical scope: Consider municipalities nearby Llinars del Vallès\nmuns &lt;- gCat %&gt;% \n  summarise(n = n(), m = round(mean(precio), 3), .by = c(municipio, id_municipio)) %&gt;% \n  filter(str_detect(municipio, \n    \"Llinars|Cardedeu|Vilamajor|Palautordera|Sant Celoni\"\n  ))\n\nknitr::kable(muns, caption = \"Average price and station count per municipality\")\n\n\nAverage price and station count per municipality\n\n\nmunicipio\nid_municipio\nn\nm\n\n\n\n\nCardedeu\n908\n4\n1.644\n\n\nLlinars del Vallès\n973\n3\n1.636\n\n\nSant Antoni de Vilamajor\n1060\n1\n1.609\n\n\nSant Celoni\n1065\n4\n1.606\n\n\nSanta Maria de Palautordera\n1123\n3\n1.593\nRetrieve daily prices for Gasolina 95 - E5 at all locations within scope. Define request parameters:\n# api end point\nfil &lt;- \"FiltroMunicipioProducto/\"\n\nt &lt;- Sys.time()\n# parameters\nanys &lt;- 1/12\nmun &lt;- set_names(muns$id_municipio, muns$municipio)\nprod &lt;- set_names(\"01\", \"gas95-e5\")\ndate &lt;- format(Sys.Date() - 1:(anys*365), \"%d-%m-%Y\")\nparams &lt;- expand_grid(date, mun, prod)\n\ngas &lt;- apply(params, 1, \\(x) mutate(get_gas(filtro = fil, args = x), date = as.Date(x[1]))) %&gt;% \n  bind_rows() %&gt;%\n  mutate(precio = as.numeric(gsub(\",\", \".\", precio_producto)))\nt &lt;- Sys.time() - t\nEvolution of average price per municipality:\nsummarise(gas, .by = c(municipio, date), price = mean(precio), desv = sd(precio)) %&gt;% \n  ggplot(aes(x = date, y = price, colour = municipio)) +\n  geom_line() +\n  labs(colour = \"Municipality\", title = \"Gas prive evolution, last 30 days\")"
  },
  {
    "objectID": "notes/en/gas_price_time/index.html#footnotes",
    "href": "notes/en/gas_price_time/index.html#footnotes",
    "title": "Evolution of gas prices in Llinars del Vallès",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nConsidering 95 gas - E5↩︎"
  },
  {
    "objectID": "about-en.html",
    "href": "about-en.html",
    "title": "Ferran Garcia",
    "section": "",
    "text": "English  Català  Español\n\n\nI am a results-driven statistician and economist with a curious mindset and proactive approach, focused on transforming complex data into actionable insights and communicating them effectively to a broad audience.\n\nEducation: Doble degree in Statistica and Economica in UB and UPC. Erasmus exchange in Maastricht (1 year) and Sevilla (6 months)\nExperience: Statistic’s university department scolarship (2 years). Commercial data analyst in Amplifon (1 year). Multiple part time jobs (referee, recepcionist, waiter, professor)\nProjects: Bayesian Statistics, Spatio - Temporal modelling, Web Scrapping, Real Estate, Financial Markets"
  }
]